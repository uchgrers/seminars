{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { seminarsApi } from \"../api/seminarsApi\";\nexport const initialState = {\n  seminars: [],\n  seminarsCount: 0,\n  pageSize: 5,\n  currentPage: 1,\n  seminarsToBeRemoved: []\n};\nexport const getSeminars = createAsyncThunk('todos/getTodos', async function () {\n  return await seminarsApi.fetchSeminars();\n});\nexport const removeSeminar = createAsyncThunk('todos/removeTodo', async function (id, {\n  dispatch\n}) {\n  dispatch(setItemToRemoval(id));\n  const result = await seminarsApi.removeSeminar(id);\n  dispatch(removeItemIdFromRemovingList(id));\n  return result;\n});\nexport const editSeminar = createAsyncThunk('todos/editTodo', async function (seminarData) {\n  return await seminarsApi.editSeminar(seminarData);\n});\nconst seminarsSlice = createSlice({\n  name: 'seminars',\n  initialState,\n  reducers: {\n    changeCurrentPage(state, action) {\n      state.currentPage = action.payload;\n    },\n    changePageSize(state, action) {\n      state.pageSize = action.payload;\n      if (state.currentPage > Math.ceil(state.seminarsCount / state.pageSize) && Math.ceil(state.seminarsCount / state.pageSize) > 0) {\n        state.currentPage = Math.ceil(state.seminarsCount / state.pageSize);\n      }\n    },\n    setItemToRemoval(state, action) {\n      state.seminarsToBeRemoved.push(action.payload);\n    },\n    removeItemIdFromRemovingList(state, action) {\n      state.seminarsToBeRemoved = state.seminarsToBeRemoved.filter(seminarId => seminarId !== action.payload);\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(getSeminars.fulfilled, (state, action) => {\n      state.seminars = action.payload;\n      state.seminarsCount = action.payload.length;\n    });\n    builder.addCase(removeSeminar.fulfilled, (state, action) => {\n      state.seminars = state.seminars.filter(seminar => seminar.id !== action.payload.id);\n      state.seminarsCount = state.seminars.length;\n    });\n    builder.addCase(editSeminar.fulfilled, (state, action) => {\n      const index = state.seminars.findIndex(seminar => seminar.id === action.payload.id);\n      if (index !== -1) {\n        state.seminars[index] = action.payload;\n      }\n    });\n  }\n});\nexport const {\n  changeCurrentPage,\n  changePageSize,\n  setItemToRemoval,\n  removeItemIdFromRemovingList\n} = seminarsSlice.actions;\nexport default seminarsSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","seminarsApi","initialState","seminars","seminarsCount","pageSize","currentPage","seminarsToBeRemoved","getSeminars","fetchSeminars","removeSeminar","id","dispatch","setItemToRemoval","result","removeItemIdFromRemovingList","editSeminar","seminarData","seminarsSlice","name","reducers","changeCurrentPage","state","action","payload","changePageSize","Math","ceil","push","filter","seminarId","extraReducers","builder","addCase","fulfilled","length","seminar","index","findIndex","actions","reducer"],"sources":["C:/Users/Nickolay/front-end/seminars-test-task/src/redux/seminarsSlice.ts"],"sourcesContent":["import {createAsyncThunk, createSlice} from \"@reduxjs/toolkit\";\nimport {\n    IdType,\n    SeminarItemType,\n    SeminarsSliceType,\n    GetSeminarsResponseType,\n    RemoveSeminarResponseType,\n} from \"../types\";\nimport {\n    seminarsApi\n} from \"../api/seminarsApi\";\n\nexport const initialState: SeminarsSliceType = {\n    seminars: [],\n    seminarsCount: 0,\n    pageSize: 5,\n    currentPage: 1,\n    seminarsToBeRemoved: []\n}\n\nexport const getSeminars = createAsyncThunk<GetSeminarsResponseType>(\n    'todos/getTodos',\n    async function () {\n        return await seminarsApi.fetchSeminars()\n    }\n)\n\nexport const removeSeminar = createAsyncThunk<RemoveSeminarResponseType, IdType>(\n    'todos/removeTodo',\n    async function (id, {dispatch}) {\n        dispatch(setItemToRemoval(id))\n        const result = await seminarsApi.removeSeminar(id)\n        dispatch(removeItemIdFromRemovingList(id))\n        return result\n    }\n)\n\nexport const editSeminar = createAsyncThunk<SeminarItemType, SeminarItemType>(\n    'todos/editTodo',\n    async function (seminarData) {\n        return await seminarsApi.editSeminar(seminarData)\n    }\n)\n\nconst seminarsSlice = createSlice({\n    name: 'seminars',\n    initialState,\n    reducers: {\n        changeCurrentPage(state, action) {\n            state.currentPage = action.payload\n        },\n        changePageSize(state, action) {\n            state.pageSize = action.payload\n            if (state.currentPage > Math.ceil(state.seminarsCount / state.pageSize) && Math.ceil(state.seminarsCount / state.pageSize) > 0) {\n                state.currentPage = Math.ceil(state.seminarsCount / state.pageSize)\n            }\n        },\n        setItemToRemoval(state, action) {\n            state.seminarsToBeRemoved.push(action.payload)\n        },\n        removeItemIdFromRemovingList(state, action) {\n            state.seminarsToBeRemoved = state.seminarsToBeRemoved.filter(seminarId => seminarId !== action.payload)\n        }\n    },\n    extraReducers: builder => {\n        builder.addCase(getSeminars.fulfilled, (state, action) => {\n            state.seminars = action.payload\n            state.seminarsCount = action.payload.length\n        })\n        builder.addCase(removeSeminar.fulfilled, (state, action) => {\n            state.seminars = state.seminars.filter(seminar => seminar.id !== action.payload.id)\n            state.seminarsCount = state.seminars.length\n        })\n        builder.addCase(editSeminar.fulfilled, (state, action) => {\n            const index = state.seminars.findIndex(seminar => seminar.id === action.payload.id);\n            if (index !== -1) {\n                state.seminars[index] = action.payload;\n            }\n        })\n    }\n})\n\nexport const {\n    changeCurrentPage,\n    changePageSize,\n    setItemToRemoval,\n    removeItemIdFromRemovingList\n} = seminarsSlice.actions\n\nexport default seminarsSlice.reducer"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}